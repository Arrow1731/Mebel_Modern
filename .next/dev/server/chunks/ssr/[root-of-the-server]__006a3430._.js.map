{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 13, "column": 0}, "map": {"version":3,"sources":["file:///D:/Nebel_WebSite/2025_DEC_MEbel/Mebel_Modern/app/orders/%5Bid%5D/page.tsx"],"sourcesContent":["// 'use client';\r\n\r\n// import { useState, useEffect } from 'react';\r\n// import { useParams } from 'next/navigation';\r\n// import { doc, onSnapshot, updateDoc, arrayUnion } from 'firebase/firestore';\r\n// import { db } from '@/lib/firebase';\r\n// import { Order } from '@/lib/types';\r\n// import { Button } from '@/components/ui/button';\r\n\r\n// const FIXED_MONTHS = [\r\n//   'Yanvar', 'Fevral', 'Mart', 'Aprel', 'May', 'Iyun',\r\n//   'Iyul', 'Avgust', 'Sentabr', 'Oktabr', 'Noyabr', 'Dekabr'\r\n// ];\r\n\r\n// export default function OrderDetailPage() {\r\n//   const { id } = useParams();\r\n//   const [order, setOrder] = useState<Order | null>(null);\r\n//   const [loading, setLoading] = useState(true);\r\n\r\n//   // === REALTIME ORDER OLISh ===\r\n//   useEffect(() => {\r\n//     const unsub = onSnapshot(doc(db, 'orders', id as string), snap => {\r\n//       if (!snap.exists()) return;\r\n\r\n//       const data = snap.data();\r\n\r\n//       setOrder({\r\n//         id: snap.id,\r\n//         ...data,\r\n//         payments:\r\n//           data.payments?.map((p: any) => ({\r\n//             ...p,\r\n//             date: p.date?.toDate?.() || new Date(),\r\n//           })) || [],\r\n//         createdAt: data.createdAt?.toDate?.() || new Date(),\r\n//         firstPaymentDate:\r\n//           data.firstPaymentDate?.toDate?.() ||\r\n//           data.createdAt?.toDate?.() ||\r\n//           new Date(),\r\n//       });\r\n\r\n//       setLoading(false);\r\n//     });\r\n\r\n//     return () => unsub();\r\n//   }, [id]);\r\n\r\n\r\n//   if (loading || !order) return <p>Yuklanmoqda...</p>;\r\n\r\n//   // === OYLIK TO‚ÄòLOV MIQDORI ===\r\n//   const monthlyAmount = Math.round(\r\n//     (Number(order.totalAmount) - Number(order.paidAmount || 0)) /\r\n//     ((order.creditMonths || 1) - (order.payments?.length || 0))\r\n//   );\r\n\r\n//   // === TO‚ÄòLOVNI YOZIB QO‚ÄòYISh ===\r\n//   const markAsPaid = async (monthIndex: number) => {\r\n//     const newPayment = {\r\n//       monthIndex,\r\n//       amount: monthlyAmount,\r\n//       date: new Date(),\r\n//     };\r\n\r\n//     await updateDoc(doc(db, 'orders', id as string), {\r\n//       payments: arrayUnion(newPayment),\r\n//       paidAmount: Number(order.paidAmount || 0) + monthlyAmount,\r\n//     });\r\n//   };\r\n\r\n//   // === KEYINGI TO‚ÄòLOV SANASI ===\r\n//   const getNextPaymentDate = (monthIndex: number) => {\r\n//     const date = new Date(order.firstPaymentDate);\r\n//     date.setMonth(date.getMonth() + monthIndex);\r\n//     return date.toLocaleDateString();\r\n//   };\r\n\r\n//   // === SORT: TO‚ÄòLANMAGAN OYLAR BOSHIDA ===\r\n//   const rows = Array.from({ length: order.creditMonths || 0 }).map((_, i) => {\r\n//     const payment = order.payments?.find(p => p.monthIndex === i);\r\n//     return { index: i, paid: Boolean(payment), payment };\r\n//   });\r\n\r\n//   rows.sort((a, b) => Number(a.paid) - Number(b.paid));\r\n\r\n//   return (\r\n//     <main className=\"oontainer p-4 md:p-6\">\r\n//       <h1 className=\"text-2xl font-bold mb-3\">{order.clientName} ‚Äî To‚Äòlov tafsiloti</h1>\r\n\r\n//       <div className=\"text-sm mb-4\">\r\n//         <p>üìû Telefon: <b>{order.clientPhone}</b></p>\r\n//         <p>üìç Manzil: {order.clientAddress}</p>\r\n//       </div>\r\n\r\n//       <div className=\"overflow-auto rounded border\">\r\n//         <table className=\"w-full text-sm min-w-[800px]\">\r\n//           <thead className=\"bg-gray-100\">\r\n//             <tr>\r\n//               <th className=\"px-3 py-2 text-left\">Oy</th>\r\n//               <th className=\"px-3 py-2 text-left\">To‚Äòlov miqdori</th>\r\n//               <th className=\"px-3 py-2 text-left\">Holat</th>\r\n//               <th className=\"px-3 py-2 text-left\">To‚Äòlov sanasi</th>\r\n//               <th className=\"px-3 py-2 text-left\">Keyingi to‚Äòlov sanasi</th>\r\n//               <th className=\"px-3 py-2 text-left\">Amal</th>\r\n//             </tr>\r\n//           </thead>\r\n\r\n//           <tbody>\r\n//             {rows.map(({ index, paid, payment }) => {\r\n//               const monthLabel = FIXED_MONTHS[index % 12];\r\n\r\n//               return (\r\n//                 <tr\r\n//                   key={index}\r\n//                   className={`border-b ${paid ? 'bg-green-50' : 'bg-yellow-50'}`}\r\n//                 >\r\n//                   {/* === 1. Oy === */}\r\n//                   <td className=\"px-3 py-2\">{monthLabel}</td>\r\n\r\n//                   {/* === 2. To‚Äòlov miqdori === */}\r\n//                   <td className=\"px-3 py-2\">\r\n//                     {monthlyAmount.toLocaleString()} so‚Äòm\r\n//                   </td>\r\n\r\n//                   {/* === 3. Holat === */}\r\n//                   <td className=\"px-3 py-2\">\r\n//                     {paid ? 'To‚Äòlangan ‚úì' : 'Kutilmoqda'}\r\n//                   </td>\r\n\r\n//                   {/* === 4. To‚Äòlov sanasi === */}\r\n//                   <td className=\"px-3 py-2\">\r\n//                     {paid ? payment?.date?.toLocaleDateString() : '-'}\r\n//                   </td>\r\n\r\n//                   {/* === 5. Keyingi to‚Äòlov sanasi === */}\r\n//                   <td className=\"px-3 py-2\">\r\n//                     {!paid ? getNextPaymentDate(index) : ''}\r\n//                   </td>\r\n\r\n//                   {/* === 6. Amal === */}\r\n//                   <td className=\"px-3 py-2\">\r\n//                     {!paid && (\r\n//                       <Button\r\n//                         className=\"bg-green-600 hover:bg-green-700 text-white\"\r\n//                         onClick={() => markAsPaid(index)}\r\n//                       >\r\n//                         To‚Äòlandi\r\n//                       </Button>\r\n//                     )}\r\n//                   </td>\r\n//                 </tr>\r\n//               );\r\n//             })}\r\n//           </tbody>\r\n//         </table>\r\n//       </div>\r\n\r\n//     </main>\r\n//   );\r\n// }"],"names":[],"mappings":"AAAA,gBAAgB;AAEhB,+CAA+C;AAC/C,+CAA+C;AAC/C,+EAA+E;AAC/E,uCAAuC;AACvC,uCAAuC;AACvC,mDAAmD;AAEnD,yBAAyB;AACzB,wDAAwD;AACxD,8DAA8D;AAC9D,KAAK;AAEL,8CAA8C;AAC9C,gCAAgC;AAChC,4DAA4D;AAC5D,kDAAkD;AAElD,oCAAoC;AACpC,sBAAsB;AACtB,0EAA0E;AAC1E,oCAAoC;AAEpC,kCAAkC;AAElC,mBAAmB;AACnB,uBAAuB;AACvB,mBAAmB;AACnB,oBAAoB;AACpB,8CAA8C;AAC9C,oBAAoB;AACpB,sDAAsD;AACtD,uBAAuB;AACvB,+DAA+D;AAC/D,4BAA4B;AAC5B,iDAAiD;AACjD,0CAA0C;AAC1C,wBAAwB;AACxB,YAAY;AAEZ,2BAA2B;AAC3B,UAAU;AAEV,4BAA4B;AAC5B,cAAc;AAGd,yDAAyD;AAEzD,oCAAoC;AACpC,sCAAsC;AACtC,oEAAoE;AACpE,kEAAkE;AAClE,OAAO;AAEP,sCAAsC;AACtC,uDAAuD;AACvD,2BAA2B;AAC3B,oBAAoB;AACpB,+BAA+B;AAC/B,0BAA0B;AAC1B,SAAS;AAET,yDAAyD;AACzD,0CAA0C;AAC1C,mEAAmE;AACnE,UAAU;AACV,OAAO;AAEP,qCAAqC;AACrC,yDAAyD;AACzD,qDAAqD;AACrD,mDAAmD;AACnD,wCAAwC;AACxC,OAAO;AAEP,+CAA+C;AAC/C,iFAAiF;AACjF,qEAAqE;AACrE,4DAA4D;AAC5D,QAAQ;AAER,0DAA0D;AAE1D,aAAa;AACb,8CAA8C;AAC9C,2FAA2F;AAE3F,uCAAuC;AACvC,wDAAwD;AACxD,kDAAkD;AAClD,eAAe;AAEf,uDAAuD;AACvD,2DAA2D;AAC3D,4CAA4C;AAC5C,mBAAmB;AACnB,4DAA4D;AAC5D,wEAAwE;AACxE,+DAA+D;AAC/D,uEAAuE;AACvE,+EAA+E;AAC/E,8DAA8D;AAC9D,oBAAoB;AACpB,qBAAqB;AAErB,oBAAoB;AACpB,wDAAwD;AACxD,6DAA6D;AAE7D,yBAAyB;AACzB,sBAAsB;AACtB,gCAAgC;AAChC,oFAAoF;AACpF,oBAAoB;AACpB,0CAA0C;AAC1C,gEAAgE;AAEhE,sDAAsD;AACtD,+CAA+C;AAC/C,4DAA4D;AAC5D,0BAA0B;AAE1B,6CAA6C;AAC7C,+CAA+C;AAC/C,4DAA4D;AAC5D,0BAA0B;AAE1B,qDAAqD;AACrD,+CAA+C;AAC/C,yEAAyE;AACzE,0BAA0B;AAE1B,6DAA6D;AAC7D,+CAA+C;AAC/C,+DAA+D;AAC/D,0BAA0B;AAE1B,4CAA4C;AAC5C,+CAA+C;AAC/C,kCAAkC;AAClC,gCAAgC;AAChC,iFAAiF;AACjF,4DAA4D;AAC5D,0BAA0B;AAC1B,mCAAmC;AACnC,kCAAkC;AAClC,yBAAyB;AACzB,0BAA0B;AAC1B,wBAAwB;AACxB,mBAAmB;AACnB,kBAAkB;AAClB,qBAAqB;AACrB,mBAAmB;AACnB,eAAe;AAEf,cAAc;AACd,OAAO;AACP,IAAI"}}]
}