{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Nebel_WebSite/V0__D/MEBEL_GOOO/Mebel_Modern/lib/firebase.ts"],"sourcesContent":["import { initializeApp } from 'firebase/app';\r\nimport { getFirestore } from 'firebase/firestore';\r\nimport { getStorage } from 'firebase/storage';\r\n\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyDzl9OP8Avxt6qvxI7H91RwA6SMwvEsfjg\",\r\n  authDomain: \"mebelweb-c3706.firebaseapp.com\",\r\n  projectId: \"mebelweb-c3706\",\r\n  storageBucket: \"mebelweb-c3706.firebasestorage.app\",\r\n  messagingSenderId: \"914008148864\",\r\n  appId: \"1:914008148864:web:36dbf5a4a738f8b72d8f65\"\r\n};\r\n\r\nconst app = initializeApp(firebaseConfig);\r\nexport const db = getFirestore(app);\r\nexport const storage = getStorage(app);\r\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;AAAA;AACA;AAAA;;;;AAEA,MAAM,iBAAiB;IACrB,QAAQ;IACR,YAAY;IACZ,WAAW;IACX,eAAe;IACf,mBAAmB;IACnB,OAAO;AACT;AAEA,MAAM,MAAM,IAAA,oMAAa,EAAC;AACnB,MAAM,KAAK,IAAA,kMAAY,EAAC;AACxB,MAAM,UAAU,IAAA,8LAAU,EAAC"}},
    {"offset": {"line": 37, "column": 0}, "map": {"version":3,"sources":["file:///D:/Nebel_WebSite/V0__D/MEBEL_GOOO/Mebel_Modern/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from 'clsx'\r\nimport { twMerge } from 'tailwind-merge'\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs))\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,yLAAO,EAAC,IAAA,gKAAI,EAAC;AACtB"}},
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file:///D:/Nebel_WebSite/V0__D/MEBEL_GOOO/Mebel_Modern/components/ui/button.tsx"],"sourcesContent":["import * as React from 'react'\r\nimport { Slot } from '@radix-ui/react-slot'\r\nimport { cva, type VariantProps } from 'class-variance-authority'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nconst buttonVariants = cva(\r\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\r\n        destructive:\r\n          'bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60',\r\n        outline:\r\n          'border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50',\r\n        secondary:\r\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\r\n        ghost:\r\n          'hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50',\r\n        link: 'text-primary underline-offset-4 hover:underline',\r\n      },\r\n      size: {\r\n        default: 'h-9 px-4 py-2 has-[>svg]:px-3',\r\n        sm: 'h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5',\r\n        lg: 'h-10 rounded-md px-6 has-[>svg]:px-4',\r\n        icon: 'size-9',\r\n        'icon-sm': 'size-8',\r\n        'icon-lg': 'size-10',\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: 'default',\r\n      size: 'default',\r\n    },\r\n  },\r\n)\r\n\r\nfunction Button({\r\n  className,\r\n  variant,\r\n  size,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<'button'> &\r\n  VariantProps<typeof buttonVariants> & {\r\n    asChild?: boolean\r\n  }) {\r\n  const Comp = asChild ? Slot : 'button'\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"button\"\r\n      className={cn(buttonVariants({ variant, size, className }))}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Button, buttonVariants }\r\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,0LAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,2LAAI,GAAG;IAE9B,qBACE,6MAAC;QACC,aAAU;QACV,WAAW,IAAA,qIAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf;KAnBS"}},
    {"offset": {"line": 120, "column": 0}, "map": {"version":3,"sources":["file:///D:/Nebel_WebSite/V0__D/MEBEL_GOOO/Mebel_Modern/app/credit-customers/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { collection, onSnapshot, updateDoc, doc, addDoc } from 'firebase/firestore';\r\nimport { db } from '@/lib/firebase';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Order } from '@/lib/types';\r\n\r\nconst FIXED_MONTHS = ['Nov', 'Dec', 'Jan', 'Feb', 'Mar'];\r\n\r\nexport default function PartialPaymentPage() {\r\n  const [orders, setOrders] = useState<Order[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [processingId, setProcessingId] = useState<string | null>(null);\r\n  const [modalOpen, setModalOpen] = useState(false);\r\n  const [modalText, setModalText] = useState('');\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = onSnapshot(collection(db, 'orders'), (snapshot) => {\r\n      const ords = snapshot.docs.map((d) => {\r\n        const data = d.data();\r\n        return {\r\n          id: d.id,\r\n          ...data,\r\n          createdAt: data.createdAt?.toDate?.() || new Date(),\r\n          dueDate: data.dueDate?.toDate?.() || new Date(),\r\n          payments:\r\n            data.payments?.map((p: any) => ({\r\n              ...p,\r\n              date: p.date?.toDate?.() || new Date(),\r\n            })) || [],\r\n        } as Order;\r\n      });\r\n      setOrders(ords);\r\n      setLoading(false);\r\n    });\r\n\r\n    return () => unsubscribe();\r\n  }, []);\r\n\r\n  const computeMonthly = (order: Order) => {\r\n    const total = Number(order.totalAmount || 0);\r\n    const months = order.creditMonths || 1;\r\n    const paid = Number(order.paidAmount || 0);\r\n    const remaining = total - paid;\r\n    return Math.round(remaining / (months - (order.payments?.length || 0)));\r\n  };\r\n\r\n  const handlePayForMonth = async (orderId: string, monthIndex: number) => {\r\n    setProcessingId(orderId);\r\n    try {\r\n      const order = orders.find((o) => o.id === orderId);\r\n      if (!order) return;\r\n\r\n      const alreadyPaid = (order.payments || []).some(\r\n        (p: any) => p.monthIndex === monthIndex\r\n      );\r\n      if (alreadyPaid) {\r\n        setModalText(`${FIXED_MONTHS[monthIndex]} oyi allaqachon to‘langan.`);\r\n        setModalOpen(true);\r\n        return;\r\n      }\r\n\r\n      const monthlyAmount = computeMonthly(order);\r\n\r\n      const paymentRecord = {\r\n        amount: monthlyAmount,\r\n        date: new Date(),\r\n        monthIndex,\r\n        monthLabel: FIXED_MONTHS[monthIndex],\r\n      };\r\n\r\n      const newPaidAmount = (order.paidAmount || 0) + monthlyAmount;\r\n      const isFullyPaid = newPaidAmount >= Number(order.totalAmount || 0);\r\n\r\n      await updateDoc(doc(db, 'orders', orderId), {\r\n        payments: [...(order.payments || []), paymentRecord],\r\n        paidAmount: newPaidAmount,\r\n        paymentStatus: isFullyPaid ? 'fully-paid' : 'partial',\r\n      });\r\n\r\n      await addDoc(collection(db, 'analytics_log'), {\r\n        type: 'monthly_payment',\r\n        orderId,\r\n        clientName: order.clientName,\r\n        amount: monthlyAmount,\r\n        monthIndex,\r\n        monthLabel: paymentRecord.monthLabel,\r\n        date: new Date(),\r\n      });\r\n\r\n      setModalText(`${FIXED_MONTHS[monthIndex]} oyi muvaffaqiyatli to‘landi.`);\r\n      setModalOpen(true);\r\n    } catch (err) {\r\n      console.error(err);\r\n      setModalText('To‘lovni amalga oshirishda xatolik yuz berdi.');\r\n      setModalOpen(true);\r\n    } finally {\r\n      setProcessingId(null);\r\n    }\r\n  };\r\n\r\n  const partiallyPaid = orders.filter(\r\n    (o) => o.paymentStatus === 'partial' || (o.paymentStatus === 'pending' && o.creditMonths > 1)\r\n  );\r\n\r\n  return (\r\n    <main className=\"min-h-screen py-10 px-4\">\r\n      <h1 className=\"text-3xl font-bold mb-6\">Bo‘lib To‘lash Mijozlar</h1>\r\n\r\n      {modalOpen && (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4\">\r\n          <div className=\"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6\">\r\n            <h3 className=\"text-xl font-semibold mb-2\">Holat</h3>\r\n            <p className=\"mb-6\">{modalText}</p>\r\n            <Button onClick={() => setModalOpen(false)} className=\"bg-amber-600 text-white\">Yopish</Button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {loading ? (\r\n        <p>Loading…</p>\r\n      ) : partiallyPaid.length === 0 ? (\r\n        <p className=\"text-gray-500\">Bo‘lib to‘lashda bo‘lgan mijozlar yo‘q.</p>\r\n      ) : (\r\n        <div className=\"overflow-auto bg-white shadow rounded-lg\">\r\n          <table className=\"w-full text-sm\">\r\n            <thead className=\"bg-gray-100\">\r\n              <tr>\r\n                <th className=\"px-4 py-2\">Mijoz</th>\r\n                <th className=\"px-4 py-2\">Telefon</th>\r\n                <th className=\"px-4 py-2\">Mahsulotlar</th>\r\n                <th className=\"px-4 py-2\">Mahsulot soni</th>\r\n                <th className=\"px-4 py-2\">Jami</th>\r\n                <th className=\"px-4 py-2\">To‘langan</th>\r\n                <th className=\"px-4 py-2\">Oylar bo‘yicha to‘lov</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {partiallyPaid.map((o) => {\r\n                const paidIndices = (o.payments || []).map((p) => p.monthIndex);\r\n                return (\r\n                  <tr key={o.id} className=\"border-b\">\r\n                    <td className=\"px-4 py-2\">{o.clientName}</td>\r\n                    <td className=\"px-4 py-2\">{o.clientPhone}</td>\r\n                    <td className=\"px-4 py-2\">{o.products?.map(p => p.productName).join(', ')}</td>\r\n                    <td className=\"px-4 py-2\">{o.products?.map(p => p.quantity).join(', ')}</td>\r\n                    <td className=\"px-4 py-2\">{Number(o.totalAmount).toLocaleString()} so‘m</td>\r\n                    <td className=\"px-4 py-2\">{Number(o.paidAmount || 0).toLocaleString()} so‘m</td>\r\n                    <td className=\"px-4 py-2 flex flex-wrap gap-2\">\r\n                      {Array.from({ length: o.creditMonths || 0 }).map((_, i) => {\r\n                        const monthly = computeMonthly(o);\r\n                        const isPaid = paidIndices.includes(i);\r\n                        return isPaid ? (\r\n                          <span key={i} className=\"px-2 py-1 bg-green-100 text-green-800 rounded text-xs\">\r\n                            {FIXED_MONTHS[i]} — Paid ✓\r\n                          </span>\r\n                        ) : (\r\n                          <Button\r\n                            key={i}\r\n                            size=\"sm\"\r\n                            disabled={processingId === o.id}\r\n                            className=\"bg-blue-600 text-white text-xs\"\r\n                            onClick={() => handlePayForMonth(o.id, i)}\r\n                          >\r\n                            Pay {FIXED_MONTHS[i]} ({monthly.toLocaleString()} so‘m)\r\n                          </Button>\r\n                        );\r\n                      })}\r\n                    </td>\r\n                  </tr>\r\n                );\r\n              })}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      )}\r\n    </main>\r\n  );\r\n}"],"names":[],"mappings":"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"}}]
}